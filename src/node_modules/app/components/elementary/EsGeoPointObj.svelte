<script>
	// eslint-disable-next-line node/no-unpublished-import
	import { createEventDispatcher } from 'svelte';
	import SimpleField from './SimpleField.svelte';
	
	const dispatch = createEventDispatcher();

	export let id = null;
	export let dataType = 'null';
	export let required = false;
	export let value = null;
	export let defaultValue = null;
	
	let type;
	
	function handleChange (payload) {
		if (!payload.lat && !payload.lon) {
			payload = null;
		}
		dispatch('change', payload);
	}
	function handleChangeLat (event) {
		handleChange({...value, lat: event.detail});
	}
	function handleChangeLon (event) {
		handleChange({...value, lon: event.detail});
	}

	function handleFocus () {

	}
	function handleBlur () {

	}

	const types = {
		'integer': 'number',
		'float': 'number',
		'string': 'text',
	};
	
	$: type = types[dataType];
</script>

<label for={id + '-lat'}>Lat</label>
<SimpleField
	id={id + '-min'}
	{type} 
	{dataType}
	value={value && value.lat}
	defaultValue={defaultValue && defaultValue.lat}
	on:change={handleChangeLat}
	on:focus={handleFocus}
	on:blur={handleBlur}
	required={required}
/>
<label for={id + '-max'}>Lon</label>
<SimpleField
	id={id + '-lon'}
	{type} 
	{dataType}
	value={value && value.lon}
	defaultValue={defaultValue && defaultValue.lon}
	on:change={handleChangeLon}
	on:focus={handleFocus}
	on:blur={handleBlur}
	required={required}
/>