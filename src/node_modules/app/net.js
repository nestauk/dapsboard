function logError (e, s) {
	console.log(e);
	console.log(s);
}

/*
class ESError extends Error {
	constructor(message, json) {
		super(message);
		this.jsonMessage = json;
	}
}
*/

export async function request (
	fetch,
	method,
	url,
	{ headers = {}, data } = {}
) {
	let reqOptions = { method, headers };
	if (data) {
		if (data instanceof FormData) {
			reqOptions.headers["content-type"] = "multipart/form-data";
			reqOptions.body = data;
		} else {
			reqOptions.headers["content-type"] = "application/json";
			reqOptions.body = JSON.stringify(data);
		}
	}
	let response;
	try {
		response = await fetch(url, reqOptions);
		if (Math.floor(response.status / 100) !== 2) {
			throw new Error(
				`API request failed! - ${response.status}: ${response.statusText}`
			);
		}
		return await response.json();
	} catch (error) {
		error.jsonMessage = await response.clone().json();
		logError(error, error.stack);
		throw error;
	}
}

export async function requestText (
	fetch,
	method,
	url,
	{ headers = {}, data } = {}
) {
	let reqOptions = { method, headers };
	if (data) {
		if (data instanceof FormData) {
			reqOptions.headers["content-type"] = "multipart/form-data";
			reqOptions.body = data;
		} else {
			reqOptions.headers["content-type"] = "application/json";
			reqOptions.body = JSON.stringify(data);
		}
	}
	let response;
	try {
		response = await fetch(url, reqOptions);
		if (Math.floor(response.status / 100) !== 2) {
			throw new Error(
				`API request failed! - ${response.status}: ${response.statusText}`
			);
		}
		return await response.text();
	} catch (error) {
		error.jsonMessage = await response.clone().text();
		logError(error, error.stack);
		throw error;
	}
}
